<%= turbo_frame_tag "api_keys_table" do %>
    <div class=" mt-10 mb-5">
      <div class="flex">
        <div class="ml-7 text-white bg-gradient-to-br from-green-400 to-blue-600 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2">
          <%= button_to "Generate New Api Token", api_keys_path, method: :post, data: { turbo: true } %>
        </div>

        <% if new_token_value %>
          <div class="flex items-center text-sm border rounded-sm px-5 py-2.5">
            <span class="font-medium">New Token</span>
            <div class="ml-4"> <%= new_token_value %> </div>
          </div>
        <% end %>
      </div>
    </div>

    <div class="relative overflow-x-auto shadow-md sm:rounded-lg mx-6 border border-gray-300">
      <table class="w-full text-sm text-left rtl:text-right">
        <thead class="divide-y-2 divide-gray-200 font-medium uppercase">
          <tr>
            <th scope="col" class="px-6 py-3">Token</th>
            <th scope="col" class="px-6 py-3">Status</th>
            <th scope="col" class="px-6 py-3">Created At</th>
            <th scope="col" class="px-6 py-3">Expires At</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <% api_keys.each do |key| %>
            <tr class="bg-white">
              <td class="px-6 py-4"><%= "#{key.type_prefix}#{key.random_prefix}#{"â€¢" * 30}" %></td>
              <td class="px-6 py-4">
                <% if key.expires_at.nil? || key.expires_at > Time.current %>
                  <span class="bg-green-100 text-green-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm border border-green-400">Active</span>
                <% else %>
                  <span class="bg-red-100 text-red-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm border border-red-400">Expired</span>
                <% end %>
              </td>
              <td class="px-6 py-4"><%= key.created_at.strftime("%Y-%m-%d %H:%M") %></td>
              <td class="px-6 py-4">
                <%= key.expires_at.present? ? key.expires_at.strftime("%Y-%m-%d %H:%M") : "Permanent" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
<% end %>
